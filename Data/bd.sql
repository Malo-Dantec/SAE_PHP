DROP TABLE IF EXISTS DONNER;
DROP TABLE IF EXISTS FAVORIS;
DROP TABLE IF EXISTS CARACTERISER;
DROP TABLE IF EXISTS CUISINER;
DROP TABLE IF EXISTS AVIS;
DROP TABLE IF EXISTS CARACTERISTIQUE;
DROP TABLE IF EXISTS TYPE_CUISINE;
DROP TABLE IF EXISTS RESTAURANT;
DROP TABLE IF EXISTS USER;
DROP TABLE IF EXISTS ADMIN;

CREATE TABLE USER (
    idUser INTEGER PRIMARY KEY AUTOINCREMENT,
    email TEXT UNIQUE,
    password TEXT NOT NULL
);

CREATE TABLE ADMIN (
    idAdmin INTEGER NOT NULL,
    email TEXT UNIQUE,
    numTel INTEGER UNIQUE,
    PRIMARY KEY (idAdmin)
);

CREATE TABLE AVIS (
    idAvis INTEGER NOT NULL,
    note INTEGER NOT NULL,
    texteAvis TEXT NOT NULL,
    PRIMARY KEY (idAvis)
);

CREATE TABLE DONNER (
    idAvis INTEGER NOT NULL,
    idUser INTEGER NOT NULL,
    datePoste INTEGER NOT NULL,
    idRestau INTEGER NOT NULL,
    PRIMARY KEY (idAvis, idUser, datePoste, idRestau),
    FOREIGN KEY (idAvis) REFERENCES AVIS (idAvis),
    FOREIGN KEY (idRestau) REFERENCES RESTAURANT (idRestau),
    FOREIGN KEY (idUser) REFERENCES USER (idUser)
);

CREATE TABLE RESTAURANT (
    idRestau INTEGER PRIMARY KEY AUTOINCREMENT,
    typeRestau TEXT,
    nomRestau TEXT NOT NULL,
    heureOuverture TEXT,
    siret TEXT,
    numTel TEXT,
    codeCommune INTEGER NOT NULL,
    nomCommune TEXT NOT NULL,
    codeRegion INTEGER,
    nomRegion TEXT NOT NULL,
    codeDepartement INTEGER NOT NULL,
    nomDepartement TEXT NOT NULL,
    latitude TEXT,
    longitude Text
);

CREATE TABLE FAVORIS (
    idRestau INTEGER NOT NULL,
    idUser INTEGER NOT NULL,
    PRIMARY KEY (idRestau, idUser),
    FOREIGN KEY (idRestau) REFERENCES RESTAURANT (idRestau),
    FOREIGN KEY (idUser) REFERENCES USER (idUser)
);
